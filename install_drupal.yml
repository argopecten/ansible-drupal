---
# This playbook will deploy Drupa 10 on a LEMP stack.
# It will first setup the LEMP stack using the setup_lemp.yml playbook.
# Then it will install Drupal on the LEMP stack.

- name: Setup LEMP with Ansible
  import_playbook: setup_lemp.yml

- name: Install Drupal with Ansible
  hosts: all
  become: true

  roles:
    - role: drupal
      vars:
        drupal_version: "10"
        drupal_download_url: "https://www.drupal.org/download-latest/zip"
        drupal_dest: "/var/www/html"
        drupal_owner: "www-data"
        drupal_group: "www-data"
        drupal_db_name: "drupal"
        drupal_db_user: "drupaluser"
        drupal_db_password: "drupalpass"
        drupal_db_host: "localhost"

  tasks:
    - name: Include Drupal role tasks
      include_role:
        name: drupal
