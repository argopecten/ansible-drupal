# /etc/ufw/user6.rules template
# {{ ansible_managed }}
# UFW user roles for {{ inventory_hostname }} generated: {{ ansible_date_time.date }}

*filter
:ufw6-user-input - [0:0]
:ufw6-user-output - [0:0]
:ufw6-user-forward - [0:0]
:ufw6-before-logging-input - [0:0]
:ufw6-before-logging-output - [0:0]
:ufw6-before-logging-forward - [0:0]
:ufw6-user-logging-input - [0:0]
:ufw6-user-logging-output - [0:0]
:ufw6-user-logging-forward - [0:0]
:ufw6-after-logging-input - [0:0]
:ufw6-after-logging-output - [0:0]
:ufw6-after-logging-forward - [0:0]
:ufw6-logging-deny - [0:0]
:ufw6-logging-allow - [0:0]
:ufw6-user-limit - [0:0]
:ufw6-user-limit-accept - [0:0]

### DEFAULT POLICIES ###
-A ufw6-user-input -j {{ ufw_default_input_policy | default('DROP') }}
-A ufw6-user-output -j {{ ufw_default_output_policy | default('ACCEPT') }}
### END DEFAULT POLICIES ###

### RULES ###
{% for rule in ufw_rules %}
# {{ rule.comment|default(rule.port ~ '/' ~ rule.proto) }}
-A ufw6-user-input -p {{ rule.proto }} --dport {{ rule.port }} -j ACCEPT
{% endfor %}
### END RULES ###

COMMIT
