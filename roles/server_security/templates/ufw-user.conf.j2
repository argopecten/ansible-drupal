# /etc/ufw/user.rules template
# {{ ansible_managed }}
# UFW user roles for {{ inventory_hostname }} generated: {{ ansible_date_time.date }}

*filter
:ufw-user-input - [0:0]
:ufw-user-output - [0:0]
:ufw-user-forward - [0:0]
:ufw-before-logging-input - [0:0]
:ufw-before-logging-output - [0:0]
:ufw-before-logging-forward - [0:0]
:ufw-user-logging-input - [0:0]
:ufw-user-logging-output - [0:0]
:ufw-user-logging-forward - [0:0]
:ufw-after-logging-input - [0:0]
:ufw-after-logging-output - [0:0]
:ufw-after-logging-forward - [0:0]
:ufw-logging-deny - [0:0]
:ufw-logging-allow - [0:0]
:ufw-user-limit - [0:0]
:ufw-user-limit-accept - [0:0]

### DEFAULT POLICIES ###
-A ufw-user-input -j {{ ufw_default_input_policy | default('DROP') }}
-A ufw-user-output -j {{ ufw_default_output_policy | default('ACCEPT') }}
### END DEFAULT POLICIES ###

### RULES ###
{% for rule in ufw_rules %}
{{ rule.comment }}
-A ufw-user-input -p {{ rule.proto }} --dport {{ rule.port }} -j ACCEPT
{% endfor %}
### END RULES ###

COMMIT
